import{i as e,o as t,c as a,w as o,a as l,n as i,b as n,t as s,r as p,d as r,e as u,I as d,s as c,f,g as h,h as m,j as g,k as y,l as _,m as k,p as x,q as $,u as v,v as C,x as b,y as T}from"./index-918ec893.js";import{_ as w,a as H}from"./app-button.288e45f9.js";import{r as S}from"./uni-app.es.8d9ae33d.js";import{_ as j,a as P,b as N,c as V}from"./app-authenticate-layout.c3411131.js";import{_ as U}from"./app-gap.851cdc6e.js";import{_ as A}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as D}from"./uni-popup.69d4e6e9.js";import"./uni-icons.c2238d17.js";import"./app-avatar.739a2587.js";const I={data:()=>({}),created(){this.popup=this.getParent()},methods:{getParent(e="uniPopup"){let t=this.$parent,a=t.$options.name;for(;a!==e;){if(t=t.$parent,!t)return!1;a=t.$options.name}return t}}},M={en:{"uni-popup.cancel":"cancel","uni-popup.ok":"ok","uni-popup.placeholder":"pleace enter","uni-popup.title":"Hint","uni-popup.shareTitle":"Share to"},"zh-Hans":{"uni-popup.cancel":"取消","uni-popup.ok":"确定","uni-popup.placeholder":"请输入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"},"zh-Hant":{"uni-popup.cancel":"取消","uni-popup.ok":"確定","uni-popup.placeholder":"請輸入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"}},{t:z}=e(M);const O=A({name:"uniPopupDialog",mixins:[I],emits:["confirm","close"],props:{inputType:{type:String,default:"text"},value:{type:[String,Number],default:""},placeholder:{type:[String,Number],default:""},type:{type:String,default:"error"},mode:{type:String,default:"base"},title:{type:String,default:""},content:{type:String,default:""},beforeClose:{type:Boolean,default:!1},cancelText:{type:String,default:""},confirmText:{type:String,default:""}},data:()=>({dialogType:"error",focus:!1,val:""}),computed:{okText(){return this.confirmText||z("uni-popup.ok")},closeText(){return this.cancelText||z("uni-popup.cancel")},placeholderText(){return this.placeholder||z("uni-popup.placeholder")},titleText(){return this.title||z("uni-popup.title")}},watch:{type(e){this.dialogType=e},mode(e){"input"===e&&(this.dialogType="info")},value(e){this.val=e}},created(){this.popup.disableMask(),"input"===this.mode?(this.dialogType="info",this.val=this.value):this.dialogType=this.type},mounted(){this.focus=!0},methods:{onOk(){"input"===this.mode?this.$emit("confirm",this.val):this.$emit("confirm"),this.beforeClose||this.popup.close()},closeDialog(){this.$emit("close"),this.beforeClose||this.popup.close()},close(){this.popup.close()}}},[["render",function(e,c,f,h,m,g){const y=r,_=u,k=d;return t(),a(_,{class:"uni-popup-dialog"},{default:o((()=>[l(_,{class:"uni-dialog-title"},{default:o((()=>[l(y,{class:i(["uni-dialog-title-text",["uni-popup__"+m.dialogType]])},{default:o((()=>[n(s(g.titleText),1)])),_:1},8,["class"])])),_:1}),"base"===f.mode?(t(),a(_,{key:0,class:"uni-dialog-content"},{default:o((()=>[p(e.$slots,"default",{},(()=>[l(y,{class:"uni-dialog-content-text"},{default:o((()=>[n(s(f.content),1)])),_:1})]),!0)])),_:3})):(t(),a(_,{key:1,class:"uni-dialog-content"},{default:o((()=>[p(e.$slots,"default",{},(()=>[l(k,{class:"uni-dialog-input",modelValue:m.val,"onUpdate:modelValue":c[0]||(c[0]=e=>m.val=e),type:f.inputType,placeholder:g.placeholderText,focus:m.focus},null,8,["modelValue","type","placeholder","focus"])]),!0)])),_:3})),l(_,{class:"uni-dialog-button-group"},{default:o((()=>[l(_,{class:"uni-dialog-button",onClick:g.closeDialog},{default:o((()=>[l(y,{class:"uni-dialog-button-text"},{default:o((()=>[n(s(g.closeText),1)])),_:1})])),_:1},8,["onClick"]),l(_,{class:"uni-dialog-button uni-border-left",onClick:g.onOk},{default:o((()=>[l(y,{class:"uni-dialog-button-text uni-button-color"},{default:o((()=>[n(s(g.okText),1)])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:3})}],["__scopeId","data-v-b888b3dc"]]);const q=A({data(){return{agree:!1,model:{userName:"",password:""},rules:{userName:{rules:[{required:!0,errorMessage:this.$t("pleaseEnterPhoneOrUserName")}]},password:{rules:[{required:!0,errorMessage:this.$t("pleaseEnterPassword")}]}}}},methods:{weixinLoginHandler(){c({icon:"none",title:this.$t("noAppId")})},navigato(e){f({url:e})},agreeChangeHandler(e){this.agree=!this.agree},confirmHandler(){this.agree=!0,this.login()},async loginHandler(){try{if(await this.$refs.form.validate(),!this.agree)return void this.$refs.dialog.open();this.login()}catch(e){}},loginSuccessAfterHandler(e){h.set(e),m().then((e=>{this.setUserInfo(e.data)})),g().then((e=>{this.setMenuData(e.data)})),y({url:"/pages/home/home"}).then((()=>{_({frontColor:"#ffffff",backgroundColor:this.$theme})}))},login(){k(this.model).then((e=>{this.loginSuccessAfterHandler(e.data)}))},...x(["setUserInfo","setMenuData"])},onLoad(){$.value.then((()=>{y({url:"/pages/home/home"}).then((()=>{_({frontColor:"#ffffff",backgroundColor:this.$theme})}))}))}},[["render",function(e,i,p,d,c,f){const h=S(v("uni-easyinput"),w),m=S(v("uni-forms-item"),j),g=S(v("uni-forms"),P),y=S(v("app-text"),N),_=u,k=S(v("app-gap"),U),x=S(v("app-button"),H),$=C,A=r,I=b,M=T,z=S(v("uni-popup-dialog"),O),q=S(v("uni-popup"),D),B=S(v("app-authenticate-layout"),V);return t(),a(B,null,{default:o((()=>[l(g,{ref:"form",rules:c.rules,model:c.model,"label-width":0},{default:o((()=>[l(m,{name:"userName"},{default:o((()=>[l(h,{primaryColor:e.$theme,inputBorder:!1,modelValue:c.model.userName,"onUpdate:modelValue":i[0]||(i[0]=e=>c.model.userName=e),placeholder:e.$t("PhoneOrUserName")},null,8,["primaryColor","modelValue","placeholder"])])),_:1}),l(m,{name:"password"},{default:o((()=>[l(h,{primaryColor:e.$theme,modelValue:c.model.password,"onUpdate:modelValue":i[1]||(i[1]=e=>c.model.password=e),type:"password",inputBorder:!1,placeholder:e.$t("password")},null,8,["primaryColor","modelValue","placeholder"])])),_:1})])),_:1},8,["rules","model"]),l(_,null,{default:o((()=>[l(y,{"like-link":"",onClick:i[2]||(i[2]=e=>f.navigato("/pages/authenticate/register/register"))},{default:o((()=>[n(s(e.$t("signUp")),1)])),_:1}),l(_,{style:{float:"right"}},{default:o((()=>[l(y,{"like-link":"",onClick:i[3]||(i[3]=e=>f.navigato("/pages/authenticate/find-password/find-password"))},{default:o((()=>[n(s(e.$t("forgotPassword")),1)])),_:1})])),_:1})])),_:1}),l(k,{gap:"20px"}),l(x,{onClick:f.loginHandler},{default:o((()=>[n(s(e.$t("login")),1)])),_:1},8,["onClick"]),l(k),l(_,null,{default:o((()=>[l(M,{style:{display:"inline-block","margin-right":"2px"},onChange:f.agreeChangeHandler},{default:o((()=>[l(I,null,{default:o((()=>[l($,{color:e.$theme,checked:c.agree,style:{transform:"scale(0.7)"}},null,8,["color","checked"]),l(A,{style:{"font-size":"14px"}},{default:o((()=>[n(s(e.$t("pleaseReadAndAgree")),1)])),_:1})])),_:1})])),_:1},8,["onChange"]),l(y,{"like-link":"",onClick:i[4]||(i[4]=e=>f.navigato("/pages/personal-center/privacy-policy/privacy-policy"))},{default:o((()=>[n(s(e.$t("privacyPolicy")),1)])),_:1})])),_:1}),l(k),l(q,{ref:"dialog",type:"center"},{default:o((()=>[l(z,{onConfirm:f.confirmHandler},{default:o((()=>[l(_,{style:{"font-size":"14px"}},{default:o((()=>[l(A,{style:{"margin-right":"2px"}},{default:o((()=>[n(s(e.$t("pleaseReadAndAgree")),1)])),_:1}),l(y,{"like-link":"",onClick:i[5]||(i[5]=e=>f.navigato("/pages/personal-center/privacy-policy/privacy-policy"))},{default:o((()=>[n(s(e.$t("privacyPolicy")),1)])),_:1})])),_:1})])),_:1},8,["onConfirm"])])),_:1},512)])),_:1})}]]);export{q as default};
